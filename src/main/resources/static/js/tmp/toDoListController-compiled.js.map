{"version":3,"sources":["../toDoListController.js"],"names":["$","document","ready","getToDoList","click","addNewToDo","on","e","keyCode","which","taskVal","val","assigneeVal","toDoPostError","postJson","jsonString","ajax","url","window","location","type","dataType","data","contentType","mimeType","success","newToDo","async","length","error","result","console","log","toString","newRow","newTableRow","assignee","task","id","append","clearForm","children","fadeOut","remove","empty","each","i","todo","setToDoProgress","html","event","preventDefault","closest","attr","idVal","putJson","removableTr","progressValues","formId","removeAttr","not","options","Object","keys","forEach","key","progress","message","after","addClass"],"mappings":"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","file":"toDoListController-compiled.js","sourcesContent":["$(document).ready(function () {\r\n\r\n    getToDoList();\r\n\r\n    $('#submit-task').click(addNewToDo);\r\n\r\n    $('#task-form').on('keydown', (function (e) {\r\n        if (e.keyCode == 13 || e.which == 13) {\r\n            addNewToDo();\r\n            return false;\r\n        }\r\n    }));\r\n\r\n    function addNewToDo() {\r\n        // event.preventDefault();\r\n        let taskVal = $('#task').val();\r\n        let assigneeVal = $('#assignee').val();\r\n        if ((assigneeVal == '' || taskVal == '') || (assigneeVal == '' && taskVal == '')) {\r\n            toDoPostError(\"Please fill form!\");\r\n            return;\r\n        }\r\n        let postJson = jsonString(1, taskVal, 'NOT_STARTED', assigneeVal);\r\n        $.ajax({\r\n            url: window.location + 'list',\r\n            type: 'POST',\r\n            dataType: 'json',\r\n            data: postJson,\r\n            contentType: 'application/json',\r\n            mimeType: 'application/json',\r\n            success: function () {\r\n\r\n                let newToDo = null;\r\n                $.ajax({\r\n                    type: 'GET',\r\n                    url: window.location + 'list',\r\n                    async: false,\r\n                    dataType: 'json',\r\n                    success: function (data) {\r\n                        newToDo = data[((data.length) - 1)];\r\n                    },\r\n                    error: function (e, result) {\r\n                        console.log('ERROR: ' + e.toString());\r\n                        newToDo = e.toString();\r\n                    }\r\n                });\r\n                let newRow = newTableRow(newToDo.assignee, newToDo.task, newToDo.id);\r\n                $('#todoTable tbody').append(newRow);\r\n                clearForm('task-form');\r\n                $('#task-form').children('span').fadeOut('slow', function () {\r\n                    $(this).remove();\r\n                });\r\n            },\r\n            error: function (e, data) {\r\n                console.log(data);\r\n                console.log('ERROR: ' + e.toString());\r\n            }\r\n        })\r\n    }\r\n\r\n    function getToDoList() {\r\n        $.ajax({\r\n            type: 'GET',\r\n            url: window.location + 'list',\r\n            success: function (result) {\r\n                if (result) {\r\n                    $('#todoTable tbody').empty();\r\n                    $.each(result, function (i, todo) {\r\n                        let newRow = newTableRow(todo.assignee, todo.task, todo.id);\r\n                        $('#todoTable tbody').append(newRow);\r\n                        setToDoProgress(todo);\r\n                    });\r\n                    console.log('Success: ', result);\r\n                } else {\r\n                    $('#getResultDiv').html('<strong>Error, no list</strong>');\r\n                    console.log('Fail: ', result);\r\n                }\r\n            },\r\n            error: function (e) {\r\n                $('#getResultDiv').html('<strong>Error</strong>');\r\n                console.log('ERROR: ', e);\r\n            }\r\n        });\r\n    }\r\n\r\n    //Maybe there is better solution for this? Previously nothing worked, because all those dropdowns are dynamically created\r\n    $('#todoTable').on('change', '.select-progress', function () {\r\n        event.preventDefault();\r\n        let id = $(this).closest('tr').attr('id');\r\n        console.log(id);\r\n        let idVal = $(this).val();\r\n        let putJson = jsonString(id, '', idVal, '');\r\n        $.ajax({\r\n            url: window.location + 'list/' + id,\r\n            type: 'PUT',\r\n            dataType: 'json',\r\n            data: putJson,\r\n            contentType: 'application/json',\r\n            mimeType: 'application/json',\r\n            success: function (data) {\r\n                console.log(data);\r\n            },\r\n            error: function (data, e) {\r\n                console.log(data);\r\n                console.log(e);\r\n            }\r\n        })\r\n    });\r\n\r\n    $('#todoTable').on('click', '.delete-task', function () {\r\n        event.preventDefault();\r\n        let id = $(this).closest('tr').attr('id');\r\n        let removableTr = $(this).closest('tr');\r\n        $.ajax({\r\n            url: window.location + 'list/' + id,\r\n            type: 'DELETE',\r\n            success: function (data) {\r\n                removableTr.fadeOut('slow', function () {\r\n                    removableTr.remove();\r\n                });\r\n            },\r\n            error: function (e) {\r\n                console.log(e);\r\n            }\r\n        })\r\n    });\r\n\r\n    let progressValues;\r\n    $.ajax({\r\n        type: 'GET',\r\n        url: window.location + 'list/taskProgress',\r\n        success: function (result) {\r\n            if (result) {\r\n                progressValues = result;\r\n            }\r\n            else {\r\n                result = null;\r\n            }\r\n        },\r\n        error: function (e) {\r\n            console.log('ERROR: ', e);\r\n            return null;\r\n        }\r\n    });\r\n\r\n\r\n    function clearForm(formId) {\r\n        $(':input', '#' + formId)\r\n            .removeAttr('checked')\r\n            .removeAttr('selected')\r\n            .not(':button, :submit, :reset, :hidden, :radio, :checkbox')\r\n            .val('');\r\n    }\r\n\r\n    function newTableRow(assignee, task, id) {\r\n\r\n        let options = \"\";\r\n        let i = 1;\r\n        Object.keys(progressValues).forEach(function (key) {\r\n            options += '<option id=\\'option-' + i + '-' + id + '\\' value=\\'' + key + '\\'>' + progressValues[key] + '</option>';\r\n            i++;\r\n        });\r\n\r\n        return '<tr class=\"to-do-info\"  id=\\'' + id + '\\'><td>' + assignee + '</td><td>' + task +\r\n            '</td><td>' +\r\n            '<form class=\\'progress-form\\' id=\\'\\'>' +\r\n            '<select class=\\'select-progress form-control\\'>' +\r\n            options +\r\n            '</select>' +\r\n            '</form>' +\r\n            '</td><td><button class=\"btn btn-danger delete-task\">Delete task</button></td>' +\r\n            '</tr>';\r\n    }\r\n\r\n    function jsonString(id, taskVal, progress, assigneeVal) {\r\n        return '{\\\"id\\\" : ' + id + ',' +\r\n            '\\\"task\\\" : \\\"' + taskVal + '\\\",' +\r\n            '\\\"progress\\\" : \\\"' + progress + '\\\",' +\r\n            '\\\"assignee\\\" :\\\"' + assigneeVal + '\\\"}'\r\n    }\r\n\r\n    function toDoPostError(message) {\r\n        $('#submit-task').after($('<span />').addClass(\"post-error label label-warning\").html(message));\r\n    }\r\n\r\n    function setToDoProgress(todo) {\r\n        let i = 1;\r\n        Object.keys(progressValues).forEach(function (key) {\r\n            if (todo.progress === progressValues[key]) {\r\n                $('#option-' + i + '-' + todo.id).attr('selected', 'selected');\r\n            }\r\n            i++;\r\n            console.log(todo.progress + ' : todo progress');\r\n            console.log(progressValues[key] + ': javascript progress')\r\n        });\r\n    }\r\n});\r\n"]}